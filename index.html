<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>title</title>
	<meta name="author" content="TikiMari">
	<meta name="description" content="Custom clothing">
	<meta name="keywords" content="clothing">
	<link rel="stylesheet" type="text/css" href="index.css">

	</style>
	</head>
	<body>

		<div id="menu-space"></div>
		<div id="design-space" class="wh100"></div>

		<script src="jquery-3.2.1.min.js" type="text/javascript"></script>
		<script src="datatree.js"></script>
		<script>
			$( document ).ready(function() {
				var menuItems = [];
				var menuTree = {};

				// Get URL
				var code = getGetParameter('design');
				if (!code) window.location.replace("?design=m0<s0<tt0>>");

				// Convert to design object tree
				var designTree = designCodeToTree(code);

				// Display menu
				document.getElementById('menu-space').innerHTML = "<p>none</p>";

			});

			function getMenuListTree(designTree, currentPath) {
				var subTree = cloneObject(designTree);
				for (var i = 0; i < currentPath.length; i++) {
					subTree = subTree[currentPath[i]];
					if (!subTree.childrenActive) break;
					subTree = subTree.childrenActive;
				}
				return subTree;
			}

			function cloneObject(obj) {
				// https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript
				return JSON.parse(JSON.stringify(obj));
			}

			function designCodeToTree(code) {
				var designTree = {};
				var codeArray = designCodeToArray(code);
				var lastC = "";
				for (var i = 0; i < codeArray.length; i++) {
					var c = codeArray[i];
					if (c[0] === "<") {
						designTree[lastC].childrenActive = designCodeToTree(c.slice(1, c.length-1));
						i++;
					} else if (isNaN(parseInt(c))) {
						designTree[c] = datatree.designs[c];
						lastC = c;
					}
				}
				return designTree;
			}

			function designCodeToArray(code) {
				return code.split(/(\d|<.*>)/g).filter(Boolean); // filter removes empty strings
			}

			function designTreeToCode(dtree) {
				var code = "";
				var keys = Object.keys(dtree);
				for (var i = 0; i < keys.length; i++) {
					code += keys[i] + "0";
					var kids = dtree[keys].childrenActive;
					if (kids) {
						for (var j = 0; j < kids.length; j++) {
							code += "<";
							code += designTreeToCode(kids[j]);
							code += ">";
						}
					}
				}
				return code;
			}

			function getGetParameter(parameterName) {
				var result = null,
					tmp = [];
				location.search
					.substr(1)
					.split("&")
					.forEach(function (item) {
					  tmp = item.split("=");
					  if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
					});
				return result;
			}
		</script>

	</body>
</html>